<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1200" height="800" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#2c3e50">
    Library Management System - Microservices Architecture
  </text>
  
  <!-- Client Layer -->
  <rect x="50" y="70" width="1100" height="80" fill="#e8f5e8" stroke="#27ae60" stroke-width="2" rx="5"/>
  <text x="600" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#27ae60">
    Client Layer
  </text>
  
  <!-- Web App -->
  <rect x="200" y="105" width="120" height="35" fill="#2ecc71" stroke="#27ae60" rx="3"/>
  <text x="260" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Web Application</text>
  
  <!-- Mobile App -->
  <rect x="350" y="105" width="120" height="35" fill="#2ecc71" stroke="#27ae60" rx="3"/>
  <text x="410" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Mobile App</text>
  
  <!-- External API -->
  <rect x="500" y="105" width="120" height="35" fill="#2ecc71" stroke="#27ae60" rx="3"/>
  <text x="560" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">External APIs</text>
  
  <!-- Postman/Testing -->
  <rect x="650" y="105" width="120" height="35" fill="#2ecc71" stroke="#27ae60" rx="3"/>
  <text x="710" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Testing Tools</text>
  
  <!-- API Gateway Layer -->
  <rect x="50" y="180" width="1100" height="100" fill="#e8f4fd" stroke="#3498db" stroke-width="2" rx="5"/>
  <text x="600" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#3498db">
    API Gateway Layer (Port 5000)
  </text>
  
  <!-- API Gateway -->
  <rect x="450" y="220" width="300" height="50" fill="#3498db" stroke="#2980b9" rx="5"/>
  <text x="600" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">
    LibraryApp.ApiGateway
  </text>
  <text x="600" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">
    Ocelot • Rate Limiting • CORS • Logging
  </text>
  
  <!-- Microservices Layer -->
  <rect x="50" y="310" width="1100" height="180" fill="#fef9e7" stroke="#f39c12" stroke-width="2" rx="5"/>
  <text x="600" y="335" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f39c12">
    Microservices Layer
  </text>
  
  <!-- Auth Service -->
  <rect x="80" y="350" width="250" height="120" fill="#e74c3c" stroke="#c0392b" rx="5"/>
  <text x="205" y="375" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">
    LibraryApp.AuthService
  </text>
  <text x="205" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Port 5001</text>
  <text x="90" y="410" font-family="Arial, sans-serif" font-size="10" fill="white">• JWT Token Generation</text>
  <text x="90" y="425" font-family="Arial, sans-serif" font-size="10" fill="white">• User Authentication</text>
  <text x="90" y="440" font-family="Arial, sans-serif" font-size="10" fill="white">• Token Validation</text>
  <text x="90" y="455" font-family="Arial, sans-serif" font-size="10" fill="white">• Role Management</text>
  
  <!-- Book Service -->
  <rect x="360" y="350" width="250" height="120" fill="#9b59b6" stroke="#8e44ad" rx="5"/>
  <text x="485" y="375" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">
    LibraryApp.BookService
  </text>
  <text x="485" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Port 5002</text>
  <text x="370" y="410" font-family="Arial, sans-serif" font-size="10" fill="white">• Book CRUD Operations</text>
  <text x="370" y="425" font-family="Arial, sans-serif" font-size="10" fill="white">• Borrowing Logic</text>
  <text x="370" y="440" font-family="Arial, sans-serif" font-size="10" fill="white">• Return Processing</text>
  <text x="370" y="455" font-family="Arial, sans-serif" font-size="10" fill="white">• Borrowing History</text>
  
  <!-- Member Service -->
  <rect x="640" y="350" width="250" height="120" fill="#1abc9c" stroke="#16a085" rx="5"/>
  <text x="765" y="375" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">
    LibraryApp.MemberService
  </text>
  <text x="765" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Port 5003</text>
  <text x="650" y="410" font-family="Arial, sans-serif" font-size="10" fill="white">• Member Registration</text>
  <text x="650" y="425" font-family="Arial, sans-serif" font-size="10" fill="white">• Profile Management</text>
  <text x="650" y="440" font-family="Arial, sans-serif" font-size="10" fill="white">• Member Status</text>
  <text x="650" y="455" font-family="Arial, sans-serif" font-size="10" fill="white">• History Aggregation</text>
  
  <!-- Shared Libraries -->
  <rect x="920" y="350" width="250" height="120" fill="#34495e" stroke="#2c3e50" rx="5"/>
  <text x="1045" y="375" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="white">
    Shared Libraries
  </text>
  <text x="930" y="400" font-family="Arial, sans-serif" font-size="10" fill="white">• LibraryApp.Shared.Models</text>
  <text x="930" y="415" font-family="Arial, sans-serif" font-size="10" fill="white">• LibraryApp.Shared.Infrastructure</text>
  <text x="930" y="430" font-family="Arial, sans-serif" font-size="10" fill="white">• LibraryApp.Shared.Events</text>
  <text x="930" y="445" font-family="Arial, sans-serif" font-size="10" fill="white">• Common Middleware</text>
  <text x="930" y="460" font-family="Arial, sans-serif" font-size="10" fill="white">• Repository Patterns</text>
  
  <!-- Data Layer -->
  <rect x="50" y="520" width="1100" height="120" fill="#f4f4f4" stroke="#7f8c8d" stroke-width="2" rx="5"/>
  <text x="600" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#7f8c8d">
    Data Layer
  </text>
  
  <!-- Auth DB -->
  <rect x="120" y="560" width="180" height="60" fill="#95a5a6" stroke="#7f8c8d" rx="3"/>
  <text x="210" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
    Auth Database
  </text>
  <text x="210" y="595" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Users • Roles • Permissions</text>
  <text x="210" y="610" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">EF Core In-Memory</text>
  
  <!-- Book DB -->
  <rect x="330" y="560" width="180" height="60" fill="#95a5a6" stroke="#7f8c8d" rx="3"/>
  <text x="420" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
    Book Database
  </text>
  <text x="420" y="595" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Books • Borrowing Records</text>
  <text x="420" y="610" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">EF Core In-Memory</text>
  
  <!-- Member DB -->
  <rect x="540" y="560" width="180" height="60" fill="#95a5a6" stroke="#7f8c8d" rx="3"/>
  <text x="630" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
    Member Database
  </text>
  <text x="630" y="595" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Members • Profiles</text>
  <text x="630" y="610" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">EF Core In-Memory</text>
  
  <!-- Redis Cache -->
  <rect x="750" y="560" width="180" height="60" fill="#e67e22" stroke="#d35400" rx="3"/>
  <text x="840" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
    Redis Cache
  </text>
  <text x="840" y="595" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Session • Performance</text>
  <text x="840" y="610" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">(Optional)</text>
  
  <!-- Cross-Cutting Concerns -->
  <rect x="50" y="670" width="1100" height="100" fill="#f8f9fa" stroke="#95a5a6" stroke-width="1" rx="5"/>
  <text x="600" y="695" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#7f8c8d">
    Cross-Cutting Concerns
  </text>
  
  <!-- Logging -->
  <rect x="80" y="710" width="150" height="40" fill="#f39c12" stroke="#e67e22" rx="3"/>
  <text x="155" y="730" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Serilog</text>
  <text x="155" y="742" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Structured Logging</text>
  
  <!-- Monitoring -->
  <rect x="250" y="710" width="150" height="40" fill="#e74c3c" stroke="#c0392b" rx="3"/>
  <text x="325" y="730" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Health Checks</text>
  <text x="325" y="742" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Service Monitoring</text>
  
  <!-- Security -->
  <rect x="420" y="710" width="150" height="40" fill="#9b59b6" stroke="#8e44ad" rx="3"/>
  <text x="495" y="730" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">JWT Security</text>
  <text x="495" y="742" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">OAuth 2.0</text>
  
  <!-- Communication -->
  <rect x="590" y="710" width="150" height="40" fill="#3498db" stroke="#2980b9" rx="3"/>
  <text x="665" y="730" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">HTTP Client</text>
  <text x="665" y="742" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Service-to-Service</text>
  
  <!-- Resilience -->
  <rect x="760" y="710" width="150" height="40" fill="#1abc9c" stroke="#16a085" rx="3"/>
  <text x="835" y="730" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Polly</text>
  <text x="835" y="742" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Circuit Breaker</text>
  
  <!-- Docker -->
  <rect x="930" y="710" width="150" height="40" fill="#34495e" stroke="#2c3e50" rx="3"/>
  <text x="1005" y="730" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Docker</text>
  <text x="1005" y="742" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Containerization</text>
  
  <!-- Arrows and Connections -->
  
  <!-- Client to API Gateway -->
  <line x1="260" y1="140" x2="500" y2="220" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="410" y1="140" x2="550" y2="220" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="560" y1="140" x2="600" y2="220" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="710" y1="140" x2="700" y2="220" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- API Gateway to Services -->
  <line x1="500" y1="270" x2="250" y2="350" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="600" y1="270" x2="485" y2="350" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="700" y1="270" x2="720" y2="350" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Services to Databases -->
  <line x1="205" y1="470" x2="210" y2="560" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="485" y1="470" x2="420" y2="560" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="765" y1="470" x2="630" y2="560" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Service-to-Service Communication -->
  <line x1="610" y1="410" x2="640" y2="410" stroke="#e74c3c" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
  <text x="625" y="405" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e74c3c">HTTP</text>
  
  <!-- Auth Service to other services -->
  <line x1="330" y1="380" x2="360" y2="380" stroke="#27ae60" stroke-width="2" stroke-dasharray="3,3" marker-end="url(#arrowhead)"/>
  <line x1="330" y1="400" x2="640" y2="400" stroke="#27ae60" stroke-width="2" stroke-dasharray="3,3" marker-end="url(#arrowhead)"/>
  <text x="400" y="375" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#27ae60">JWT Validation</text>
  
  <!-- Shared Libraries connections -->
  <line x1="920" y1="380" x2="890" y2="380" stroke="#95a5a6" stroke-width="1" stroke-dasharray="2,2"/>
  <line x1="920" y1="400" x2="610" y2="400" stroke="#95a5a6" stroke-width="1" stroke-dasharray="2,2"/>
  <line x1="920" y1="420" x2="330" y2="420" stroke="#95a5a6" stroke-width="1" stroke-dasharray="2,2"/>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
  </defs>
  
  <!-- Legend -->
  <rect x="50" y="660" width="200" height="5" fill="#2c3e50"/>
  <text x="60" y="655" font-family="Arial, sans-serif" font-size="9" fill="#2c3e50">HTTP Request Flow</text>
  
  <rect x="270" y="660" width="200" height="5" fill="#e74c3c" stroke-dasharray="5,5"/>
  <text x="280" y="655" font-family="Arial, sans-serif" font-size="9" fill="#e74c3c">Service-to-Service Communication</text>
  
  <rect x="490" y="660" width="200" height="5" fill="#27ae60" stroke-dasharray="3,3"/>
  <text x="500" y="655" font-family="Arial, sans-serif" font-size="9" fill="#27ae60">Authentication Flow</text>
  
</svg>
